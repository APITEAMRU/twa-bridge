import e from"debug";const t="web",s="phone",a="desktop",r=()=>{const e=window.location.hash.slice(1),r=new URLSearchParams(e).get("tgWebAppPlatform")??"ios";return["android","ios"].includes(r)?s:["tdesktop","macos"].includes(r)?a:t},o="not_supported",n=(e,t)=>{const s=new URLSearchParams(window.location.hash.slice(1)).get("tgWebAppVersion");return Number(s)>=e&&-1!==t.indexOf(r())},i=()=>Math.random().toString(36).substring(3,9),_=e=>{var t;if(t=/^\s*#([0-9a-f]{6})\s*$/i.exec(e+=""))return"#"+t[1].toLowerCase();if(t=/^\s*#([0-9a-f])([0-9a-f])([0-9a-f])\s*$/i.exec(e))return("#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]).toLowerCase();if(t=/^\s*rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+\.{0,1}\d*))?\)\s*$/.exec(e)){var s=parseInt(t[1]),a=parseInt(t[2]),r=parseInt(t[3]);return"#"+((s<16?"0":"")+s.toString(16))+((a<16?"0":"")+a.toString(16))+((r<16?"0":"")+r.toString(16))}return!1},p=()=>u()?(be(Be),{status:!0}):(ce(Be,1),{status:o}),u=()=>n(0,[t,a,s]),d=()=>c()?(be(Me),{status:!0}):(ce(Me,1),{status:o}),c=()=>n(6.4,[s]),g=e=>b()?(be(Ae,e),{status:!0}):(ce(Ae,1),{status:o}),b=()=>n(0,[t,a,s]),l=()=>w()?(be(Ue),{status:!0}):(ce(Ue,1),{status:o}),w=()=>n(0,[s]),m=e=>h()?(be(Ge,e),{status:!0}):(ce(Ge,1),{status:o}),h=()=>n(0,[t]),f=()=>v()?(be(Ge),{status:!0}):(ce(Ge,1),{status:o}),v=()=>n(0,[t]),y="web_app_invoke_custom_method",S=async e=>q()?(void 0===e.req_id&&(e.req_id=i()),be(y,e),new Promise(((t,s)=>{const a=s=>{s.req_id===e.req_id&&(t({status:!0,data:s}),Ce(me,a))};Ne(me,a)}))):(ce(y,1),{status:o}),q=()=>n(6.9,[t,a,s]),x=e=>k()?(be(Qe,e),{status:!0}):(ce(Qe,1),{status:o}),k=()=>n(6.1,[t,a,s]),P=e=>O()?(be(Fe,e),{status:!0}):(ce(Fe,1),{status:o}),O=()=>n(6.4,[t,a,s]),I=async e=>R()?(e.title.length>64&&ce(He,3),e.message.length<1&&ce(He,4),e.message.length>256&&ce(He,5),e.buttons.length<1&&ce(He,6),e.buttons.length>3&&ce(He,7),void 0!==e.buttons.find((e=>e.text?.match(/^(ok|close|cancel)$/g)))&&ce(He,8),be(He,e),new Promise(((t,s)=>{const a=s=>{t({status:!!e.buttons.find((e=>e.id===s?.button_id)),data:s}),Ce(ye,a)};Ne(ye,a)}))):(ce(He,1),{status:o}),R=()=>n(6.2,[t,a,s]),T=async e=>N()?(be(De,e),new Promise(((t,s)=>{Le(qe,(s=>{e.is_close&&d(),t({status:!0,data:s})})),Le(xe,(()=>{t({status:"closed"})}))}))):(ce(De,1),{status:o}),N=()=>n(6.4,[s]),C=e=>("/"!==e.path_full[0]&&(e.path_full="/"+e.path_full),L()?(be(je,e),{status:!0}):(ce(je,1),{status:o})),L=()=>n(7,[t,a,s]),W=async e=>E()?(void 0===e.req_id&&(e.req_id=i()),be(Je,e),new Promise(((t,s)=>{const a=s=>{s.req_id===e.req_id&&(t({status:!0,data:s}),Ce(we,a))};Ne(we,a)}))):(ce(Je,1),{status:o}),E=()=>n(6.4,[t,a,s]),D=()=>J()?(be(ze),{status:!0}):(ce(ze,1),{status:o}),J=()=>n(6.9,[t,a,s]),$=async()=>B()?(be($e),new Promise(((e,t)=>{Le(ve,(t=>{"sent"===t.status&&e({status:!0}),e({status:!1})}))}))):(ce($e,1),{status:o}),B=()=>n(6.9,[t,a,s]),M=()=>A()?(be(Ke),{status:!0}):(ce(Ke,1),{status:o}),A=()=>n(0,[t,a,s]),U=()=>G()?(be(Xe),{status:!0}):(ce(Xe,1),{status:o}),G=()=>n(0,[t,a,s]),V=()=>Q()?(be(Ye),{status:!0}):(ce(Ye,1),{status:o}),Q=()=>n(6.9,[t,a,s]),F=e=>H()?(be(Ze,e),{status:!0}):(ce(Ze,1),{status:o}),H=()=>n(6.1,[t,a,s]),j=e=>z()?(be(et,e),{status:!0}):(ce(et,1),{status:o}),z=()=>n(6.1,[t,a,s]),K=e=>X()?(be(tt,e),{status:!0}):(ce(tt,1),{status:o}),X=()=>n(6.1,[t,a,s]),Y=e=>Z()?(be(st,e),{status:!0}):(ce(st,1),{status:o}),Z=()=>n(0,[t,a,s]),ee=e=>te()?(be(at,e),{status:!0}):(ce(at,1),{status:o}),te=()=>n(0,[t,a,s]),se=e=>ae()?(be(rt,e),{status:!0}):(ce(rt,1),{status:o}),ae=()=>n(6.1,[t,a,s]),re=e=>oe()?(e.query.length>256&&ce(ot,9),be(ot,e),{status:!0}):(ce(ot,1),{status:o}),oe=()=>n(6.7,[t,a,s]),ne=e=>ie()?(be(nt,e),{status:!0}):(ce(nt,1),{status:o}),ie=()=>n(6.1,[s]),_e=({key:e,value:t})=>{try{return window.sessionStorage.setItem("__telegram__"+e,JSON.stringify(t)),{status:!0}}catch(e){}return{status:!1}},pe=()=>!0,ue=({key:e})=>{try{return{value:JSON.parse(window.sessionStorage.getItem("__telegram__"+e)??""),status:!0}}catch(e){}return{status:!1}},de=()=>!0;var ce=(e,t)=>{"development"===process.env.NODE_ENV&&console.error(`[@apiteam/twa-bridge](${e}) = ${t}`)};const ge=()=>{const e=new URLSearchParams(window.location.hash.slice(1)).get("tgWebAppData");if(null===e)return ce("getInitData",2),null;const t=new URLSearchParams(e);let s={};return t.forEach(((e,t)=>{if(s[t]=e,void 0!==t.match(/^(chat|receiver|user)$/g))try{s[t]=JSON.parse(e)}catch{}})),s};var be=(t,s)=>{if(window.TelegramWebviewProxy)window.TelegramWebviewProxy.postEvent(t,JSON.stringify(s));else if(window.external&&"notify"in window.external)window.external.notify(JSON.stringify({eventType:t,eventData:s}));else try{"*",window.parent.postMessage(JSON.stringify({eventType:t,eventData:s}),"*")}catch(t){e("postMessage Iframe",10)}};const le="back_button_pressed",we="clipboard_text_received",me="custom_method_invoked",he="invoice_closed",fe="main_button_pressed",ve="phone_requested",ye="popup_closed",Se="reload_iframe",qe="qr_text_received",xe="scan_qr_popup_closed",ke="set_custom_style",Pe="settings_button_pressed",Oe="theme_changed",Ie="viewport_changed",Re="write_access_requested",Te=((e=new Map)=>({once:(t,s,a=e.get(t),r=(e=>{s(e),a&&a.splice(a.indexOf(s)>>>0,1)}))=>a?a.push(r):e.set(t,[r]),on:(t,s,a=e.get(t))=>a?a.push(s):e.set(t,[s]),off:(t,s,a=e.get(t))=>a&&s?a.splice(a.indexOf(s)>>>0,1):e.set(t,[]),emit:(t,s,a=e.get(t)||[])=>{for(const e of a)e(s)}}))();(()=>{function e(e,t){e===Oe&&(t.theme_params=(e=>{"#1c1c1d"==e.bg_color&&e.bg_color==e.secondary_bg_color&&(e.secondary_bg_color="#2c2c2e");const t=window.location.hash.slice(1),s=new URLSearchParams(t);var a=JSON.parse(s.get("tgWebAppThemeParams")??"");for(var r in e){var o=_(e[r]);"string"==typeof o&&(a[r]=o)}return a})(t.theme_params)),Te.emit(e,t),Te.emit("*",{name:e,data:t})}window.TelegramGameProxy_receiveEvent=e,window.Telegram={WebView:{receiveEvent:e}},window.TelegramGameProxy={receiveEvent:e}})();const Ne=(e,t)=>{Te.on(e,t)},Ce=(e,t)=>{Te.off(e,t)},Le=(e,t)=>{Te.once(e,t)};var We=Object.freeze({__proto__:null,off:Ce,on:Ne,once:Le});const Ee="web_app_invoke_custom_method",De="web_app_open_scan_qr_popup",Je="web_app_read_text_from_clipboard",$e="web_app_request_phone",Be="web_app_close",Me="web_app_close_scan_qr_popup",Ae="web_app_data_send",Ue="web_app_expand",Ge="iframe_ready",Ve="iframe_will_reload",Qe="web_app_open_invoice",Fe="web_app_open_link",He="web_app_open_popup",je="web_app_open_tg_link",ze="web_app_ready",Ke="web_app_request_theme",Xe="web_app_request_viewport",Ye="web_app_request_write_access",Ze="web_app_set_background_color",et="web_app_set_header_color",tt="web_app_setup_back_button",st="web_app_setup_closing_behavior",at="web_app_setup_main_button",rt="web_app_setup_settings_button",ot="web_app_switch_inline_query",nt="web_app_trigger_haptic_feedback";export{le as EventBackButtonPressed,we as EventClipboardTextReceived,me as EventCustomMethodInvoked,he as EventInvoiceClosed,fe as EventMainButtonPressed,ve as EventPhoneRequested,ye as EventPopupClosed,qe as EventQrTextReceived,Se as EventReloadIframe,xe as EventScanQrPopupClosed,ke as EventSetCustomStyle,Pe as EventSettingsButtonPressed,Oe as EventThemeChanged,Ie as EventViewportChanged,Re as EventWriteAccessRequested,Be as MethodClose,Me as MethodCloseScanQrPopup,Ae as MethodDataSend,Ue as MethodExpand,Ge as MethodIframeReady,Ve as MethodIframeWillReload,Ee as MethodInvokeCustomMethod,Qe as MethodOpenInvoice,Fe as MethodOpenLink,He as MethodOpenPopup,De as MethodOpenScanQrPopup,je as MethodOpenTgLink,Je as MethodReadTextFromClipboard,ze as MethodReady,$e as MethodRequestPhone,Ke as MethodRequestTheme,Xe as MethodRequestViewport,Ye as MethodRequestWriteAccess,Ze as MethodSetBackgroundColor,et as MethodSetHeaderColor,tt as MethodSetupBackButton,st as MethodSetupClosingBehavior,at as MethodSetupMainButton,rt as MethodSetupSettingsButton,ot as MethodSwitchInlineQuery,nt as MethodTriggerHapticFeedback,o as NOT_SUPPORTED,a as TG_DESKTOP,s as TG_PHONE,t as TG_WEB,p as bridgeClose,d as bridgeCloseScanQrPopup,g as bridgeDataSend,l as bridgeExpand,ge as bridgeGetInitData,m as bridgeIframeReady,f as bridgeIframeWillReload,S as bridgeInvokeCustomMethod,x as bridgeOpenInvoice,P as bridgeOpenLink,I as bridgeOpenPopup,T as bridgeOpenScanQrPopup,C as bridgeOpenTgLink,W as bridgeReadTextFromClipboard,D as bridgeReady,$ as bridgeRequestPhone,M as bridgeRequestTheme,U as bridgeRequestViewport,V as bridgeRequestWriteAccess,ue as bridgeSessionStorageGet,_e as bridgeSessionStorageSet,F as bridgeSetBackgroundColor,j as bridgeSetHeaderColor,K as bridgeSetupBackButton,Y as bridgeSetupClosingBehavior,ee as bridgeSetupMainButton,se as bridgeSetupSettingsButton,re as bridgeSwitchInlineQuery,ne as bridgeTriggerHapticFeedback,ce as debug,r as getPlatform,We as listener,be as sender,u as supportClose,c as supportCloseScanQrPopup,b as supportDataSend,w as supportExpand,h as supportIframeReady,v as supportIframeWillReload,q as supportInvokeCustomMethod,k as supportOpenInvoice,O as supportOpenLink,R as supportOpenPopup,N as supportOpenScanQrPopup,L as supportOpenTgLink,E as supportReadTextFromClipboard,J as supportReady,B as supportRequestPhone,A as supportRequestTheme,G as supportRequestViewport,Q as supportRequestWriteAccess,de as supportSessionStorageGet,pe as supportSessionStorageSet,H as supportSetBackgroundColor,z as supportSetHeaderColor,X as supportSetupBackButton,Z as supportSetupClosingBehavior,te as supportSetupMainButton,ae as supportSetupSettingsButton,oe as supportSwitchInlineQuery,ie as supportTriggerHapticFeedback};
