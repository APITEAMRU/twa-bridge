import e from"sender";import{listener as t}from"solid";import{createSignal as s,onMount as a,onCleanup as o}from"solid-js";const p=e=>{},n="web",r="phone",u="desktop",_=(e,t)=>{const s=new URLSearchParams(window.location.hash.slice(1)).get("tgWebAppVersion");return Number(s)>=e&&-1!==t.indexOf((()=>{const e=window.location.hash.slice(1),t=new URLSearchParams(e).get("tgWebAppPlatform")??"ios";return["android","ios"].includes(t)?r:["tdesktop","macos"].includes(t)?u:n})())},i="web_app_close",d=()=>c()?(b(i),{status:!0}):{status:"not_supported"},c=()=>_(0,[n,u,r]);var b=(e,t)=>{window.TelegramWebviewProxy?window.TelegramWebviewProxy.postEvent(e,JSON.stringify(t)):window.external&&"notify"in window.external&&window.external.notify(JSON.stringify({eventType:e,eventData:t}))};const l="web_app_close_scan_qr_popup",g=()=>w()?(b(l),{status:!0}):{status:"not_supported"},w=()=>_(6.4,[r]),h="web_app_data_send",m=e=>f()?(b(h,e),{status:!0}):{status:"not_supported"},f=()=>_(0,[n,u,r]),v="web_app_expand",y=()=>S()?(b(v),{status:!0}):{status:"not_supported"},S=()=>_(0,[r]),x="iframe_ready",q=e=>k()?(b(x,e),{status:!0}):{status:"not_supported"},k=()=>_(0,[n]),P="iframe_will_reload",O=()=>R()?(b(P),{status:!0}):{status:"not_supported"},R=()=>_(0,[n]),T="web_app_invoke_custom_method",W=e=>C()?(b(T,e),{status:!0}):{status:"not_supported"},C=()=>_(6.9,[n,u,r]),B="web_app_open_invoice",E=e=>I()?(b(B,e),{status:!0}):{status:"not_supported"},I=()=>_(6.1,[n,u,r]),L="web_app_open_link",A=e=>D()?(b(L,e),{status:!0}):{status:"not_supported"},D=()=>_(6.4,[n,u,r]),N="web_app_open_popup",U=e=>G()?(e.title.length,e.message.length,e.message.length,e.buttons.length,e.buttons.length,e.buttons.find((e=>e.text?.match(/^(ok|close|cancel)$/g))),b(N,e),{status:!0}):{status:"not_supported"},G=()=>_(6.2,[n,u,r]),J="web_app_open_scan_qr_popup",M=async e=>Q()?(b(J,e),new Promise(((t,s)=>{Ue("qr_text_received",(s=>{e.is_close&&g(),t({status:!0,data:s})})),Ue("scan_qr_popup_closed",(()=>{t({status:"closed",data:{data:void 0}})}))}))):{status:"not_supported",data:{data:void 0}},Q=()=>_(6.4,[r]),V="web_app_open_tg_link",j=e=>("/"!==e.path_full[0]&&(e.path_full="/"+e.path_full),F()?(b(V,e),{status:!0}):{status:"not_supported"}),F=()=>_(7,[n,u,r]),H="web_app_read_text_from_clipboard",$=e=>z()?(b(H,e),{status:!0}):{status:"not_supported"},z=()=>_(6.4,[n,u,r]),K="web_app_ready",X=()=>Y()?(b(K),{status:!0}):{status:"not_supported"},Y=()=>_(6.9,[n,u,r]),Z="web_app_request_phone",ee=async()=>te()?(b(Z),new Promise(((e,t)=>{Ue("phone_requested",(t=>{"sent"===t.status&&e({status:!0}),e({status:!1})}))}))):{status:"not_supported"},te=()=>_(6.9,[n,u,r]),se="web_app_request_theme",ae=()=>oe()?(b(se),{status:!0}):{status:"not_supported"},oe=()=>_(0,[n,u,r]),pe="web_app_request_viewport",ne=()=>re()?(b(pe),{status:!0}):{status:"not_supported"},re=()=>_(0,[n,u,r]),ue="web_app_request_write_access",_e=()=>ie()?(b(ue),{status:!0}):{status:"not_supported"},ie=()=>_(6.9,[n,u,r]),de="web_app_set_background_color",ce=e=>be()?(b(de,e),{status:!0}):{status:"not_supported"},be=()=>_(6.1,[n,u,r]),le="web_app_set_header_color",ge=e=>we()?(b(le,e),{status:!0}):{status:"not_supported"},we=()=>_(6.1,[n,u,r]),he="web_app_setup_back_button",me=e=>fe()?(b(he,e),{status:!0}):{status:"not_supported"},fe=()=>_(6.1,[n,u,r]),ve="web_app_setup_closing_behavior",ye=e=>Se()?(b(ve,e),{status:!0}):{status:"not_supported"},Se=()=>_(0,[n,u,r]),xe="web_app_setup_main_button",qe=e=>ke()?(b(xe,e),{status:!0}):{status:"not_supported"},ke=()=>_(0,[n,u,r]),Pe="web_app_setup_settings_button",Oe=e=>Re()?(b(Pe,e),{status:!0}):{status:"not_supported"},Re=()=>_(6.1,[n,u,r]),Te="web_app_switch_inline_query",We=e=>Ce()?(e.query.length,b(Te,e),{status:!0}):{status:"not_supported"},Ce=()=>_(6.7,[n,u,r]),Be="web_app_trigger_haptic_feedback",Ee=e=>Ie()?(b(Be,e),{status:!0}):{status:"not_supported"},Ie=()=>_(6.1,[r]),Le=()=>{const e=new URLSearchParams(window.location.hash.slice(1)).get("tgWebAppData");if(null===e)return null;const t=new URLSearchParams(e);let s={};return t.forEach(((e,t)=>{if(s[t]=e,void 0!==t.match(/^(chat|receiver|user)$/g))try{s[t]=JSON.parse(e)}catch{}})),s},Ae=()=>{const[p,n]=s({height:0,is_expanded:!1,is_state_stable:!1}),r=e=>n(e);return a((()=>{t.on("viewport_changed",r),e("web_app_request_viewport")})),o((()=>{t.off("viewport_changed",r)})),p},De=((e=new Map)=>({once:(t,s,a=e.get(t),o=(e=>{s(e),a&&a.splice(a.indexOf(s)>>>0,1)}))=>a?a.push(o):e.set(t,[o]),on:(t,s,a=e.get(t))=>a?a.push(s):e.set(t,[s]),off:(t,s,a=e.get(t))=>a&&s?a.splice(a.indexOf(s)>>>0,1):e.set(t,[]),emit:(t,s,a=e.get(t)||[])=>{for(const e of a)e(s)}}))(),Ne=()=>{function e(e,t){De.emit(e,t),De.emit("*",{name:e,data:t})}window.TelegramGameProxy_receiveEvent=e,window.Telegram={WebView:{receiveEvent:e}},window.TelegramGameProxy={receiveEvent:e}};Ne();const Ue=(e,t)=>{De.once(e,t)};var Ge=Object.freeze({__proto__:null,listenerStart:Ne,off:(e,t)=>{De.off(e,t)},on:(e,t)=>{De.on(e,t)},once:Ue});export{u as TG_DESKTOP,r as TG_PHONE,n as TG_WEB,d as bridgeClose,g as bridgeCloseScanQrPopup,m as bridgeDataSend,y as bridgeExpand,Le as bridgeGetInitData,q as bridgeIframeReady,O as bridgeIframeWillReload,W as bridgeInvokeCustomMethod,E as bridgeOpenInvoice,A as bridgeOpenLink,U as bridgeOpenPopup,M as bridgeOpenScanQrPopup,j as bridgeOpenTgLink,$ as bridgeReadTextFromClipboard,X as bridgeReady,ee as bridgeRequestPhone,ae as bridgeRequestTheme,ne as bridgeRequestViewport,_e as bridgeRequestWriteAccess,ce as bridgeSetBackgroundColor,ge as bridgeSetHeaderColor,me as bridgeSetupBackButton,ye as bridgeSetupClosingBehavior,qe as bridgeSetupMainButton,Oe as bridgeSetupSettingsButton,We as bridgeSwitchInlineQuery,Ee as bridgeTriggerHapticFeedback,Ae as createIsViewportChanged,p as debug,Ge as listener,b as sender,c as supportClose,w as supportCloseScanQrPopup,f as supportDataSend,S as supportExpand,k as supportIframeReady,R as supportIframeWillReload,C as supportInvokeCustomMethod,I as supportOpenInvoice,D as supportOpenLink,G as supportOpenPopup,Q as supportOpenScanQrPopup,F as supportOpenTgLink,z as supportReadTextFromClipboard,Y as supportReady,te as supportRequestPhone,oe as supportRequestTheme,re as supportRequestViewport,ie as supportRequestWriteAccess,be as supportSetBackgroundColor,we as supportSetHeaderColor,fe as supportSetupBackButton,Se as supportSetupClosingBehavior,ke as supportSetupMainButton,Re as supportSetupSettingsButton,Ce as supportSwitchInlineQuery,Ie as supportTriggerHapticFeedback};
